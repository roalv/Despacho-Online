â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           ğŸš¨ IMPORTANTE: CRIAR TABELAS NO SUPABASE ğŸš¨              â•‘
â•‘                                                                    â•‘
â•‘  As tabelas precisam ser criadas manualmente no Supabase.         â•‘
â•‘  Siga os passos abaixo (leva 2 minutos):                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ PASSO A PASSO:

1ï¸âƒ£  Acesse: https://supabase.com/dashboard

2ï¸âƒ£  Selecione seu projeto: yxdufeiphenwlnnqbwji

3ï¸âƒ£  No menu lateral esquerdo, clique em: "SQL Editor"

4ï¸âƒ£  Clique no botÃ£o: "+ New Query"

5ï¸âƒ£  COPIE E COLE TODO O SQL ABAIXO na caixa de texto:

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

-- Criar tabela CLIENTES
CREATE TABLE IF NOT EXISTS clientes (
  id TEXT PRIMARY KEY,
  nome TEXT NOT NULL,
  nif TEXT NOT NULL,
  telefone TEXT,
  email TEXT,
  endereco TEXT,
  "createdAt" TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- Criar tabela DOCUMENTOS_CLIENTES
CREATE TABLE IF NOT EXISTS documentos_clientes (
  id TEXT PRIMARY KEY,
  "clienteId" TEXT NOT NULL,
  "fileUrl" TEXT NOT NULL,
  "fileName" TEXT NOT NULL,
  "fileType" TEXT,
  "uploadedAt" TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  FOREIGN KEY ("clienteId") REFERENCES clientes(id) ON DELETE CASCADE
);

-- Criar tabela DESPACHOS
CREATE TABLE IF NOT EXISTS despachos (
  id TEXT PRIMARY KEY,
  "clienteId" TEXT NOT NULL,
  destino TEXT NOT NULL,
  "dataEmbarque" DATE,
  "numeroContentor" TEXT,
  estado TEXT DEFAULT 'Em aberto',
  "createdAt" TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  FOREIGN KEY ("clienteId") REFERENCES clientes(id) ON DELETE CASCADE
);

-- Criar tabela DOCUMENTOS_DESPACHOS
CREATE TABLE IF NOT EXISTS documentos_despachos (
  id TEXT PRIMARY KEY,
  "despachoId" TEXT NOT NULL,
  "fileUrl" TEXT NOT NULL,
  "fileName" TEXT NOT NULL,
  "fileType" TEXT,
  "uploadedAt" TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  FOREIGN KEY ("despachoId") REFERENCES despachos(id) ON DELETE CASCADE
);

-- Criar tabela PRODUTOS
CREATE TABLE IF NOT EXISTS produtos (
  id TEXT PRIMARY KEY,
  "despachoId" TEXT NOT NULL,
  nome TEXT NOT NULL,
  peso DECIMAL(10,2),
  quantidade INTEGER,
  valor DECIMAL(10,2),
  "hsCode" TEXT,
  "createdAt" TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  FOREIGN KEY ("despachoId") REFERENCES despachos(id) ON DELETE CASCADE
);

-- Habilitar Row Level Security (RLS)
ALTER TABLE clientes ENABLE ROW LEVEL SECURITY;
ALTER TABLE documentos_clientes ENABLE ROW LEVEL SECURITY;
ALTER TABLE despachos ENABLE ROW LEVEL SECURITY;
ALTER TABLE documentos_despachos ENABLE ROW LEVEL SECURITY;
ALTER TABLE produtos ENABLE ROW LEVEL SECURITY;
ALTER TABLE pauta ENABLE ROW LEVEL SECURITY;

-- Criar polÃ­ticas de acesso
DROP POLICY IF EXISTS "Allow all operations" ON clientes;
CREATE POLICY "Allow all operations" ON clientes FOR ALL USING (true);

DROP POLICY IF EXISTS "Allow all operations" ON documentos_clientes;
CREATE POLICY "Allow all operations" ON documentos_clientes FOR ALL USING (true);

DROP POLICY IF EXISTS "Allow all operations" ON despachos;
CREATE POLICY "Allow all operations" ON despachos FOR ALL USING (true);

DROP POLICY IF EXISTS "Allow all operations" ON documentos_despachos;
CREATE POLICY "Allow all operations" ON documentos_despachos FOR ALL USING (true);

DROP POLICY IF EXISTS "Allow all operations" ON produtos;
CREATE POLICY "Allow all operations" ON produtos FOR ALL USING (true);

DROP POLICY IF EXISTS "Allow all operations" ON pauta;
CREATE POLICY "Allow all operations" ON pauta FOR ALL USING (true);

-- Criar Ã­ndices para performance
CREATE INDEX IF NOT EXISTS idx_clientes_created ON clientes("createdAt" DESC);
CREATE INDEX IF NOT EXISTS idx_despachos_cliente ON despachos("clienteId");
CREATE INDEX IF NOT EXISTS idx_despachos_estado ON despachos(estado);
CREATE INDEX IF NOT EXISTS idx_produtos_despacho ON produtos("despachoId");
CREATE INDEX IF NOT EXISTS idx_pauta_codigo ON pauta(codigo);
CREATE INDEX IF NOT EXISTS idx_pauta_descricao ON pauta(descricao);

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

6ï¸âƒ£  Clique no botÃ£o verde "RUN" (ou pressione Ctrl+Enter)

7ï¸âƒ£  Aguarde aparecer "Success. No rows returned"

8ï¸âƒ£  CRIAR BUCKETS DE STORAGE:
   
   a) No menu lateral, clique em "Storage"
   b) Clique em "+ New bucket"
   c) Nome: documentos-clientes
   d) Marque "Public bucket" âœ…
   e) Clique em "Create bucket"
   
   f) Repita para criar o segundo bucket:
      Nome: documentos-despachos
      Marque "Public bucket" âœ…
      Clique em "Create bucket"

9ï¸âƒ£  VERIFICAR SE DEU CERTO:
   
   a) VÃ¡ em "Table Editor" no menu lateral
   b) VocÃª deve ver as tabelas:
      âœ… clientes
      âœ… documentos_clientes
      âœ… despachos
      âœ… documentos_despachos
      âœ… produtos
      âœ… pauta (jÃ¡ existia)

ğŸ‰ PRONTO! Agora sua aplicaÃ§Ã£o vai funcionar perfeitamente!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸  Se aparecer algum erro ao rodar o SQL, me avise qual Ã© o erro!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
